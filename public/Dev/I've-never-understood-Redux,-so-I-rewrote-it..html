<!DOCTYPE html>
<html lang="fr"><head><title>I've never understood Redux, so I rewrote it.</title><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="I've never understood Redux, so I rewrote it."/><meta property="og:description" content="Understanding Redux by coding the source"/><meta property="og:image" content="https://aamulumi.info/_assets/headers/redux.webp"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><meta property="article:published_time" content="2019-01-25T00:00:00.000Z"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="Understanding Redux by coding the source"/><meta name="generator" content="Quartz"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Noto Sans Display:wght@400;700&amp;family=Libre Baskerville:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap&amp;family=Outfit" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="Dev/I've-never-understood-Redux,-so-I-rewrote-it."><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><div><h1 id="site-title" class="page-title"><a href="..">Pink in the dark</a></h1><h2 class="page-sub-title">Discussions et √©crits autour de la tech, des jeux vid√©os, de la sociologie et de la musique</h2></div><div class="spacer mobile-only"></div><div class="search-container"><div class="search"><div id="search-icon"><p>Recherche</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Rechercher quelque chose" placeholder="Rechercher quelque chose"/><div id="search-layout" data-preview="true"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>Mode sombre</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>Mode clair</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div></div><div class="spacer mobile-only"></div><div class="explorer"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[{&quot;path&quot;:&quot;Autre&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Dev&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Dev/Infra&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Dev/Patterns&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Musique&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Sociologie&quot;,&quot;collapsed&quot;:true}]"><h1>üïµÔ∏è Explorateur</h1><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Autre"><button class="folder-button"><span class="folder-title">Autre</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Autre"><li><a href="../Autre/Cr√©ation-d'un-droit-de-cong√©-m√©dical-de-courte-dur√©e-pour-les-salari√©s" data-for="Autre/Cr√©ation-d'un-droit-de-cong√©-m√©dical-de-courte-dur√©e-pour-les-salari√©s">Cr√©ation d'un droit de cong√© m√©dical de courte dur√©e pour les salari√©s</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Dev"><button class="folder-button"><span class="folder-title">Dev</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Dev"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Dev/Infra"><button class="folder-button"><span class="folder-title">Infra</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Dev/Infra"><li><a href="../Dev/Infra/Mise-en-place-d'un-Grafana-pour-g√©rer-les-m√©triques-de-CleverCloud" data-for="Dev/Infra/Mise-en-place-d'un-Grafana-pour-g√©rer-les-m√©triques-de-CleverCloud">Mise en place d'un Grafana pour g√©rer les m√©triques de CleverCloud</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Dev/Patterns"><button class="folder-button"><span class="folder-title">Patterns</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Dev/Patterns"><li><a href="../Dev/Patterns/i18n'em-all-with-Singleton" data-for="Dev/Patterns/i18n'em-all-with-Singleton">i18n'em all with Singleton</a></li><li><a href="../Dev/Patterns/Observer---The-JS-Way" data-for="Dev/Patterns/Observer---The-JS-Way">Observer - The JS Way</a></li><li><a href="../Dev/Patterns/Queue---The-JS-Way" data-for="Dev/Patterns/Queue---The-JS-Way">Queue - The JS Way</a></li><li><a href="../Dev/Patterns/Singleton---The-JS-way" data-for="Dev/Patterns/Singleton---The-JS-way">Singleton - The JS way</a></li></ul></div></li><li><a href="../Dev/Comment-j'ai-hack√©-le-dino-de-Chrome" data-for="Dev/Comment-j'ai-hack√©-le-dino-de-Chrome">Comment j'ai hack√© le dino de Chrome</a></li><li><a href="../Dev/I've-never-understood-Redux,-so-I-rewrote-it." data-for="Dev/I've-never-understood-Redux,-so-I-rewrote-it.">I've never understood Redux, so I rewrote it.</a></li><li><a href="../Dev/Non,-on-ne-forme-pas-une-d√©veloppeuse-ou-un-d√©veloppeur-en-6-mois" data-for="Dev/Non,-on-ne-forme-pas-une-d√©veloppeuse-ou-un-d√©veloppeur-en-6-mois">Non, on ne forme pas une d√©veloppeuse ou un d√©veloppeur en 6 mois</a></li><li><a href="../Dev/The-Useless-Type-Array-Sorter-in-Typescript" data-for="Dev/The-Useless-Type-Array-Sorter-in-Typescript">The Useless Type Array Sorter in Typescript</a></li><li><a href="../Dev/The-Useless-Type-Calculator-in-Typescript" data-for="Dev/The-Useless-Type-Calculator-in-Typescript">The Useless Type Calculator in Typescript</a></li><li><a href="../Dev/Tous-les-trucs-pour-briller-comme-d√©veloppeur‚Ä¢euse" data-for="Dev/Tous-les-trucs-pour-briller-comme-d√©veloppeur‚Ä¢euse">Tous les trucs pour briller comme d√©veloppeur‚Ä¢euse</a></li><li><a href="../Dev/Type-the-Untypable" data-for="Dev/Type-the-Untypable">Type the Untypable</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Musique"><button class="folder-button"><span class="folder-title">Musique</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Musique"><li><a href="../Musique/Et-la-machine-dev√Ænt-artiste" data-for="Musique/Et-la-machine-dev√Ænt-artiste">Et la machine dev√Ænt artiste</a></li><li><a href="../Musique/La-musique-des-souvenirs" data-for="Musique/La-musique-des-souvenirs">La musique des souvenirs</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Sociologie"><button class="folder-button"><span class="folder-title">Sociologie</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Sociologie"><li><a href="../Sociologie/Quid-d'un-monde-sans-travail" data-for="Sociologie/Quid-d'un-monde-sans-travail">Quid d'un monde sans travail</a></li><li><a href="../Sociologie/Vers-une-nouvelle-conception-du-travail" data-for="Sociologie/Vers-une-nouvelle-conception-du-travail">Vers une nouvelle conception du travail</a></li></ul></div></li></ul></div></li><li id="explorer-end"></li></ul></div></div><div class="recent-notes desktop-only"><h3>üìù Derniers articles</h3><ul class="recent-ul"><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Dev/The-Useless-Type-Array-Sorter-in-Typescript">The Useless Type Array Sorter in Typescript</a></h3></div><div class="desc"><h5>The stupid idea came back</h5></div><ul class="tags"><li><a class="tag-link" href="../tags/typescript">#typescript</a></li><li><a class="tag-link" href="../tags/typings">#typings</a></li><li><a class="tag-link" href="../tags/array">#array</a></li></ul><p class="meta">11 nov. 2024</p></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Dev/Tous-les-trucs-pour-briller-comme-d√©veloppeur‚Ä¢euse">Tous les trucs pour briller comme d√©veloppeur‚Ä¢euse</a></h3></div><ul class="tags"><li><a class="tag-link" href="../tags/dev">#dev</a></li></ul><p class="meta">17 mai 2024</p></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Dev/Non,-on-ne-forme-pas-une-d√©veloppeuse-ou-un-d√©veloppeur-en-6-mois">Non, on ne forme pas une d√©veloppeuse ou un d√©veloppeur en 6 mois</a></h3></div><div class="desc"><h5>R√©flexions sur la formation courte au d√©veloppement informatique</h5></div><ul class="tags"><li><a class="tag-link" href="../tags/formation">#formation</a></li><li><a class="tag-link" href="../tags/d√©veloppement">#d√©veloppement</a></li><li><a class="tag-link" href="../tags/critique">#critique</a></li></ul><p class="meta">22 f√©vr. 2024</p></div></li></ul></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element-container"><div class="breadcrumb-element"><a href="../">Home</a></div><p> ‚ùØ </p></div><div class="breadcrumb-element-container"><div class="breadcrumb-element"><a href="../Dev/">Dev</a></div><p> ‚ùØ </p></div><div class="breadcrumb-element-container"><div class="breadcrumb-element"><a href>I've never understood Redux, so I rewrote it.</a></div></div></nav><div><div class="header-image-container"><div class="header-image-gradient"></div><img class="header-image" src="/_assets/headers/redux.webp"/><h1 class="article-decoration-title-on-image">I've never understood Redux, so I rewrote it.</h1><div class="article-informations-container"><h1 class="article-title-on-image">I've never understood Redux, so I rewrote it.</h1><div class="article-subtitle-on-image">Understanding Redux by coding the source</div></div><div class="article-meta-container"><p class="content-meta">25 janv. 2019 - 12 min de lecture</p></div></div></div><ul class="tags"><li><a href="../tags/javascript" class="internal tag-link">#javascript</a></li><li><a href="../tags/redux" class="internal tag-link">#redux</a></li><li><a href="../tags/react" class="internal tag-link">#react</a></li></ul></div></div><article class="popover-hint"><p><em>I‚Äôve been using Redux for a few years. It‚Äôs cool! I can manage the state of my application in a single Store with many reducers. But‚Ä¶ wait, what is really a store? A reducer? An action? Let‚Äôs decrypt it!</em></p>
<p><em>Note: I wrote this article after having prepared a talk on the same subject. This article is more or less this talk‚Äôs retranscription (with all I want to say on the subject). If you‚Äôre interested, I can present the talk at some conference, so you can contact me at florian[at]kbdev[dot]io. Thanks a lot and have a good read!</em></p>
<p>Yeah, <strong>Redux</strong>! Honestly, I know there‚Äôs so much better ways to store state and all the things related to <strong>Redux</strong>. But I began to write <strong>React</strong> applications with it, and it was cool. Except I remember when I began to use it, it looks like learning to play Dwarf Fortress.</p>
<p><span class="img-container" style="justify-content:center;">
												<img src="../_assets/articles/redux/dwarfFortressDifficulty.webp" width="auto" height="auto" alt="Replace Dwarf Fortress with Redux"/>
												<span class="img-caption" style="text-align:center;">Replace Dwarf Fortress with Redux</span>
											</span>
Each time I wrote an action, I was sure some strange bugs would happen. What did this dispatch function do? How could I connect it to my <strong>React</strong> app? And, clearly the best: <strong>how could I write this f*cking async function</strong>?</p>
<p>After writing a Typescript typed version of <strong>Redux</strong>, I saw the light: <strong>Redux is incredibly simple</strong>. I can now (and, after reading this article, you will be able to) write a Redux in 5 minutes. With <em>async</em> and <em>history</em> handling. Sounds cool huh?</p>
<p>Let‚Äôs do some magic!</p>
<h2 id="what-is-redux">What is Redux?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#what-is-redux" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<blockquote>
<p>A predictable state container for JavaScript apps.</p>
</blockquote>
<p><span class="img-container" style="justify-content:center;">
												<img src="../_assets/articles/redux/whut.webp" width="auto" height="auto" alt="Me. I'm a penguin."/>
												<span class="img-caption" style="text-align:center;">Me. I'm a penguin.</span>
											</span>
Hmmm ‚Ä¶ let‚Äôs try something better.</p>
<p>Imagine <strong>Redux</strong> like a big object which contains all global variables of your application. You cannot mutate directly this object. You need to call some functions to change it.</p>
<p>A simple example is saying <strong>Redux</strong> is your bank. You have an amount on your account and you can only change this amount by doing some operations. An operation is an <strong>action</strong> (or mutation) and your account is the <strong>Store‚Äôs data</strong>.</p>
<h3 id="action--i-do-an-operation">Action ‚Äî I do an operation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#action--i-do-an-operation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Each mutation is done by passing an action.</strong></p>
<p>An action is just a simple Javascript object with a unique key (to recognize which action we are doing) and the data of the action. This little object is given to a function <code>dispatch()</code> which sends it.</p>
<p>In the bank example, an <strong>action</strong> is something like this:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="js" data-theme="github-dark github-light"><code data-language="js" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">{</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">	&quot;type&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;ADD_AMOUNT_ON_ACCOUNT&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span data-line><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">	&quot;value&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">23.96</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></figure>
<p>To avoid doing some errors when typing the unique key of the action, we can create an <strong>Action Creator</strong>. This is just a function which creates the object. Something like this:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="js" data-theme="github-dark github-light"><code data-language="js" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> ADD_AMOUNT_ON_ACCOUNT</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &quot;ADD_AMOUNT_ON_ACCOUNT&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> REMOVE_AMOUNT_FROM_ACCOUNT</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &quot;REMOVE_AMOUNT_FROM_ACCOUNT&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> addAmountOnAccount</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">amount</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    amount,</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    type: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">ADD_AMOUNT_ON_ACCOUNT</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  };</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span data-line> </span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> removeAmountOnAccount</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">amount</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    amount,</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    type: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">REMOVE_AMOUNT_ON_ACCOUNT</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  };</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">module</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">exports</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  ADD_AMOUNT_ON_ACCOUNT,</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  REMOVE_AMOUNT_FROM_ACCOUNT,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  addAmountOnAccount,</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  removeAmountOnAccount</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">};</span></span></code></pre></figure>
<h2 id="reducer--i-treat-the-operation">Reducer ‚Äî I treat the operation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#reducer--i-treat-the-operation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><strong>Each variable available in the application is a reducer.</strong></p>
<p>A <strong>Reducer</strong> is a function which returns the data for the current variable. It can be, for example, the state for the option ‚Äúdark mode enabled‚Äù of your application. Or, in the bank example, the amount of money on all accounts.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="js" data-theme="github-dark github-light"><code data-language="js" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  ADD_AMOUNT_ON_ACCOUNT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">,</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">  REMOVE_AMOUNT_FROM_ACCOUNT</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">} </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">&quot;./accountActions&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">module</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">exports</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> accountAmount</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">state</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { value: </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> }, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">action</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  switch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (action.type) {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    case</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> ADD_AMOUNT_ON_ACCOUNT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { value: state.value </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">+</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> action.value };</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    case</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> REMOVE_AMOUNT_FROM_ACCOUNT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> { value: state.value </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> action.value };</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    default</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">:</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> state;</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">};</span></span></code></pre></figure>
<p>Each time you give a new action to a <strong>reducer</strong>, it will check if this type of action must be handled. If that is the case, the <strong>reducer</strong> will create a new output value which corresponds to the <strong>reducer new state</strong>.</p>
<p>These functions must be pure and without any side effect. These two conditions just tell:</p>
<ul>
<li><strong>a function must return the same result with the same arguments.</strong> (ex: a function which computes an addition is pure.)</li>
<li><strong>a function must not do any modification to the environment.</strong> (ex: a function which mutates an argument has a side-effect.)</li>
</ul>
<p>These conditions allow <strong>Redux</strong> to be completely <strong>predictable</strong>. If your functions always do the same things with the same arguments, you will always get the same result by computing the same sequence of actions at any time. So you can easily test your code or create reproducible error logs.</p>
<p>The <em>default state</em> is here because (<em>spoiler alert</em>) <strong>the Store dispatches any action to all reducers</strong>. So we need to return the current state if the treated <strong>action</strong> hasn‚Äôt any incidence on the current <strong>reducer</strong>.</p>
<h3 id="store--where-all-happens">Store ‚Äî Where all happens<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#store--where-all-happens" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Until here, we didn‚Äôt have code any <strong>Redux</strong> file. Because <strong>Redux</strong> is just the <strong>Store</strong>. This is where all the magic happens.</p>
<p>A <strong>Store</strong> is an object which propagates <strong>actions</strong> in <strong>reducers</strong> and keeps the current state in memory. In <strong>Redux</strong>, you can also listen to any change in the <strong>Store</strong> with the <strong>subscribe()</strong> method.</p>
<p>For the bank, the <strong>Store</strong> is the system which handles operations. The <strong>Store</strong> calls the system, and the system updates accounts.</p>
<p>To create the <strong>Store</strong>, we will use a simple ES6 Class with 2 attributes: <em>state</em> to keep the last state of the application and <em>reducers</em> to keep the reducers of the application.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="js" data-theme="github-dark github-light"><code data-language="js" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Store</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  constructor</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">reducers</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._reducers </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> reducers;</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {};</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></figure>
<p>The next step is one of the biggest steps we will do: creating the <strong>dispatch</strong> function. This is the famous function which does all the job in <strong>Redux</strong>.</p>
<p>The algorithm is :</p>
<ul>
<li>1: Get all reducers</li>
<li>2: Create an object <code>NextState</code>.</li>
<li>3: For each reducer <code>R</code> with its name <code>Name</code>, call the reducer R and store its result in <code>NextState[Name]</code>.</li>
<li>4: Replace the previous <code>this.state</code> by <code>NextState</code>.</li>
</ul>
<p><span class="img-container" style="justify-content:center;">
													<img src="../_assets/articles/redux/thatsallquestion.webp" width="auto" height="auto" alt/>
												</span></p>
<p>Yeah. That‚Äôs all. Nothing more.</p>
<p>Writing this code is not really complicated. I use the <strong>Array.reduce()</strong> method to call each <strong>reducer</strong> and compute a new <strong>state</strong>.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="js" data-theme="github-dark github-light"><code data-language="js" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Store</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  constructor</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">reducers</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._reducers </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> reducers;</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {};</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // Don't forget that because dispatch() can lose its context</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.dispatch </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.dispatch.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">bind</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // We also add a init call to create the default state of Store</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">({type: </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;">'__INIT__'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">});</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">  dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">action</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // Get all reducers names</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> reducersNames</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> Object.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">keys</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._reducers);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // Compute the new current state of the application</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    //  by propagating the action</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> nextState</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> reducersNames.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">reduce</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">newState</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">name</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">      // Just call each reducer with the current state of the reducer</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">      //  and the action</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      newState[name] </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._reducers[name](</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state[name], action);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> newState;</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }, {});</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // Keep the new state in memory</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> nextState;</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">  getState</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">() {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    return</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state;</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></figure>
<p>I also added the <strong>getState()</strong> method which only returns the current <strong>state</strong> of the <strong>Store</strong>. To be <strong>Redux-compliant</strong>, we also need two things: <em>subscribers</em> and <em>middlewares</em>. We will not speak about <em>middlewares</em>: they are not extremely difficult to implement, but you don‚Äôt probably need them because you can add everything you need directly in your own version of <strong>Redux</strong>.</p>
<p>For friends of the <em>Gang of Four</em>, <em>subscribers</em> are a simple <strong>Observer pattern</strong>.</p>
<h3 id="-long-version-for-the-observer-pattern-go-to-the-next-comment-if-you-dont-need-it">// Long version for the Observer pattern. Go to the next comment if you don‚Äôt need it.<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#-long-version-for-the-observer-pattern-go-to-the-next-comment-if-you-dont-need-it" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>An <strong>Observer</strong> is one of the simplest patterns described in the <a href="https://sophia.javeriana.edu.co/~cbustaca/docencia/DSBP-2018-01/recursos/Erich%20Gamma,%20Richard%20Helm,%20Ralph%20Johnson,%20John%20M.%20Vlissides-Design%20Patterns_%20Elements%20of%20Reusable%20Object-Oriented%20Software%20%20-Addison-Wesley%20Professional%20(1994).pdf" class="external">Design Patterns<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> book from Gamma, Helm, Johnson, and Vlissides (<em>the Gang of Four</em>), an OOP design patterns book. This pattern is also known as <strong>Listener</strong> or <strong>Subscriber</strong>.</p>
<p>You need at least two objects to use this pattern:</p>
<ul>
<li>the <strong>Subject</strong> is the object we are waiting for information. When this object will do an update, it will send its new state to all <strong>Observers</strong>.</li>
<li>an <strong>Observer</strong> is an object waiting for an update of the <strong>Subject</strong>. It will do something when the Subject tells him it has been updated.</li>
</ul>
<p>This pattern allows to add and to remove any new <strong>Observer</strong> to the <strong>Subject</strong> at any time, so we have a low dependency between our objects.</p>
<p>In our case, the <strong>Subject</strong> is the <strong>Store</strong>.</p>
<p>To implement this pattern in Javascript, we only need to add a <code>subscribe()</code> method which will return the <code>unsubscribe()</code> method when we add a <strong>Subscriber</strong> and keep the new subscriber in an array of <strong>subscribers</strong>. And we must add the call to the <strong>subscribers</strong> when a new <strong>state</strong> is created.</p>
<h3 id="-end-of-long-version-for-the-observer-pattern">// End of long version for the Observer pattern.<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#-end-of-long-version-for-the-observer-pattern" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>In term of code for <strong>subscribers</strong> implementation, we got this.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="js" data-theme="github-dark github-light"><code data-language="js" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Store</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  constructor</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">reducers</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // ... </span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // New code</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.subscribers </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> [];</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">  dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">action</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // ...</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    </span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // New code : call each observer with the new state</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.subscribers.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">forEach</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">subscriber</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      subscriber</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state);</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    });</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // New code</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">  subscribe</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">subscriber</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.subscribers.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">push</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(subscriber);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // Return the unsubscribe function</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> () </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">      this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.subscribers.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">splice</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.subscribers.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">indexOf</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(subscriber), </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    };</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></figure>
<p>Not a lot of code. That‚Äôs cool.</p>
<p>And‚Ä¶ you have your version of <strong>Redux</strong>.</p>
<p><span class="img-container" style="justify-content:center;">
												<img src="../_assets/articles/redux/what1.webp" width="auto" height="auto" alt="You."/>
												<span class="img-caption" style="text-align:center;">You.</span>
											</span>
Eheh. Yes. Dan Abramov got 46000 stars on Github with this. Our prophet has one of the best number of lines/stars ratio of Github. (<em>If you‚Äôre reading this and you‚Äôre Dan, please, I want a dedicated portrait of you on my desk. We can marry us too, but a portrait can be a good beginning.</em>)</p>
<h2 id="time-to-go-to-redux">Time to go to Redux++<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#time-to-go-to-redux" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Ok, we have the basis. But I‚Äôm sure you want to have at least one of the most complex feature to deal with <strong>Redux</strong>: asynchronous function handling.</p>
<p><span class="img-container" style="justify-content:center;">
												<img src="../_assets/articles/redux/volcano.webp" width="auto" height="auto" alt="My brain. Your brain. Everyone‚Äôs brain reading that."/>
												<span class="img-caption" style="text-align:center;">My brain. Your brain. Everyone‚Äôs brain reading that.</span>
											</span>
It‚Äôs ok. We will do this together. Without banned words like <strong>thunk</strong> and <strong>saga</strong> and <strong>any-way-to-do-async-without-doing-anything-but-I-never-understood-this</strong>.</p>
<p>Our async handling system will use functions. We will consider that <strong>action can be a function</strong> instead of an object. This function will take the <strong>dispatch()</strong> method from the <strong>Store</strong> as parameter. So we can create an <strong>action</strong> that will call himself the <strong>dispatch()</strong> method when we need to dispatch a new <strong>action</strong>.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="js" data-theme="github-dark github-light"><code data-language="js" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> ADD_AMOUNT_ON_ACCOUNT</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &quot;ADD_AMOUNT_ON_ACCOUNT&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> REMOVE_AMOUNT_FROM_ACCOUNT</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> &quot;REMOVE_AMOUNT_FROM_ACCOUNT&quot;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// For the fun, it simulates the same process</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">// than Paypal when you want to verify your account</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> verifyAccount</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">() {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">removeAmountOnAccount</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0.30</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">));</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    // Simulate asynchronous treatment</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">    setTimeout</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(() </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">       dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">addAmountOnAccount</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">0.30</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">));</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">1000</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></figure>
<p>In this case, we are just considering that any <strong>action</strong> which is a function is an <strong>Async Action</strong>. So we just have to check if the <strong>action</strong> in <code>dispatch()</code> is a function and call it in this case. Else, only do what we did before.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="js" data-theme="github-dark github-light"><code data-language="js" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Store</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // Just renamed the old dispatch to _dispatch</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">  _dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">action</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> reducersNames</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> Object.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">keys</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._reducers);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    const</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> nextState</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> reducersNames.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">reduce</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">newState</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">name</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">      newState[name] </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._reducers[name](</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state[name], action);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      return</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> newState;</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }, {});</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> nextState;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.subscribers.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">forEach</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">subscriber</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">=></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> {</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">      subscriber</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">._state);</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    });</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">  // New code</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">  dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#FFAB70;--shiki-light:#E36209;">action</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">typeof</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> action </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">===</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62;"> 'function'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">) {</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">      return</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> action</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.dispatch);</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">    }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">    this</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">_dispatch</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(action);</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">  }</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></figure>
<p>5 new lines of codes. You can write only one line with a fat-arrow and a ternary operator.</p>
<p>And now you are handling <strong>async functions</strong>.</p>
<p><span class="img-container" style="justify-content:center;">
												<img src="../_assets/articles/redux/magic.webp" width="auto" height="auto" alt="You. Me. Everyone."/>
												<span class="img-caption" style="text-align:center;">You. Me. Everyone.</span>
											</span>
The best thing is you can write every system you want based on <strong>Redux</strong>. If you are totally Redux-compliant**, you can replace your current <code>redux</code> with your own new system in <code>react-redux</code>. That‚Äôs what we did on an internal project at KBDev.</p>
<h2 id="redux-is-minimalist-and-magic-its-the-perfection">Redux is minimalist and magic. It‚Äôs the perfection.<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#redux-is-minimalist-and-magic-its-the-perfection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>I‚Äôm not sure for this statement.</p>
<p><span class="img-container" style="justify-content:center;">
												<img src="../_assets/articles/redux/what2.webp" width="auto" height="auto" alt="You."/>
												<span class="img-caption" style="text-align:center;">You.</span>
											</span>
Hmm yes, I wrote this article on <strong>Redux</strong> and I‚Äôm saying that this library is not a solution for all problems.</p>
<p>We must think about a few things.</p>
<p>First, if you are using <strong>React</strong>, there‚Äôs a lot of API features which will be soon added. Just take a look at the <a href="https://reactjs.org/docs/context.html" class="external">Context API<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>, the <a href="https://medium.com/@Charles_Stover/react-suspense-with-the-fetch-api-a1b7369b0469" class="external">Suspense API<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> or the amazing <a href="https://reactjs.org/docs/hooks-reference.html" class="external">Hooks API<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>. All of these APIs are solutions for problems where <strong>Redux</strong> was used.</p>
<p>Secondly, in an article named <a href="https://medium.com/@dan_abramov/you-might-not-need-redux-be46360cf367" class="external">You Might Not Need Redux<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> from our lord Dan himself, he wrote we perhaps need <strong>Redux</strong> because we don‚Äôt have understood how to code with <strong>React</strong>.</p>
<blockquote>
<p>However, if you‚Äôre just learning React, don‚Äôt make Redux your first choice.</p>
<p><strong>Instead learn to think in React.</strong></p>
<p>Come back to Redux if you find a real need for it, or if you want to try something new. But approach it with caution, just like you do with any highly opinionated tool.</p>
<p>If you feel pressured to do things ‚Äúthe Redux way‚Äù, it may be a sign that you or your teammates are taking it too seriously. It‚Äôs just one of the tools in your toolbox, an experiment gone wild.</p>
</blockquote>
<p>{% include image.html url=‚Äú/assets/images/danAbramov.jpeg‚Äù description=‚ÄúThe Lord and Saviour of the Earth.‚Äù %}</p>
<p>Thirdly, I wrote this article to prove you that you don‚Äôt always need to do an <strong>npm install</strong> each time. A lot of libraries are just some concepts you can recreate and complete with your needs.</p>
<p>Lastly, <strong>Redux</strong> must be appreciated like a design pattern instead of a library. We need to remember how we can create some simple state management software with <strong>reducers</strong>. You can reuse this pattern to make internal reducers for components or anything else. For example, I‚Äôve done an HTTP fetch hook based on an internal reducer. And it works like a charm.</p>
<p>Here‚Äôs <a href="https://twitter.com/AamuLumi/status/1055760174118567936?s=20" class="external">an example I wrote<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>;</p>
<p>We need to remember that we can invent things. I‚Äôm sure if you have read this article you are interested in how software pieces work. On how can we create complex systems with just some lines of code. That‚Äôs what we have to do: always learn new and efficient ways to do a better job. And that‚Äôs the magic of our job: we are paid to hit our f***ing keyboard to display rainbows and unicorns on all screens of the universe. And that‚Äôs cool! So let‚Äôs do some great unicorns instead of evil and ugly dead hell pony!</p>
<p><span class="img-container" style="justify-content:center;">
													<img src="../_assets/articles/redux/unicorn.webp" width="auto" height="auto" alt/>
												</span></p>
<p>There‚Äôs a <strong>Github</strong> repository with all the code of this article and my own <strong>Typescript</strong> special version of <strong>Redux</strong> called <strong>Zebulon</strong>. All are available here: <a href="https://github.com/kb-dev/redux-recoded" class="external">Redux-Recoded repository<svg class="external-icon" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>. You can use this code in your projects. And if you have some questions, just ask them in comments, I will try to answer them.</p>
<p>Thanks a lot for reading! :)</p>
<p>And thanks for Jean Batista and J√©r√©my Turon for correcting my bad English.</p></article></div><div class="right sidebar"><div class="toc desktop-only"><button type="button" id="toc" class><h3>üìñ Table des Mati√®res</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-0"><a href="#what-is-redux" data-for="what-is-redux">What is Redux?</a></li><li class="depth-1"><a href="#action--i-do-an-operation" data-for="action--i-do-an-operation">Action ‚Äî I do an operation</a></li><li class="depth-0"><a href="#reducer--i-treat-the-operation" data-for="reducer--i-treat-the-operation">Reducer ‚Äî I treat the operation</a></li><li class="depth-1"><a href="#store--where-all-happens" data-for="store--where-all-happens">Store ‚Äî Where all happens</a></li><li class="depth-1"><a href="#-long-version-for-the-observer-pattern-go-to-the-next-comment-if-you-dont-need-it" data-for="-long-version-for-the-observer-pattern-go-to-the-next-comment-if-you-dont-need-it">// Long version for the Observer pattern. Go to the next comment if you don‚Äôt need it.</a></li><li class="depth-1"><a href="#-end-of-long-version-for-the-observer-pattern" data-for="-end-of-long-version-for-the-observer-pattern">// End of long version for the Observer pattern.</a></li><li class="depth-0"><a href="#time-to-go-to-redux" data-for="time-to-go-to-redux">Time to go to Redux++</a></li><li class="depth-0"><a href="#redux-is-minimalist-and-magic-its-the-perfection" data-for="redux-is-minimalist-and-magic-its-the-perfection">Redux is minimalist and magic. It‚Äôs the perfection.</a></li></ul></div></div></div></div><footer class><hr/><ul><li><a href="https://rivals.space/@aamulumi">Mastodon</a></li><li><a href="https://github.com/AamuLumi/blog-next">GitHub</a></li><li><a href="https://soundcloud.com/aamulumi">SoundCloud</a></li></ul><p>Cr√©√© √† partir de l'incroyable  <a href="https://quartz.jzhao.xyz/">Quartz v4.2.2</a> ¬© 2024</p></footer></div></body><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script src="../postscript.js" type="module"></script></html>